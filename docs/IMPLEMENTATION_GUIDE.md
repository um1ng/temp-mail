# ä¸´æ—¶é‚®ç®±æœåŠ¡å®æ–½æŒ‡å—

> ğŸ“… æ›´æ–°æ—¶é—´ï¼š2025å¹´1æœˆ  
> ğŸ¯ çŠ¶æ€ï¼šç”Ÿäº§å°±ç»ª

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å®‰è£…ä¾èµ–
pnpm install

# å¯åŠ¨æœåŠ¡å®¹å™¨
docker-compose up -d

# åˆå§‹åŒ–æ•°æ®åº“
npx prisma generate
npx prisma migrate dev

# å¯åŠ¨åº”ç”¨
pnpm dev
```

### 2. è®¿é—®åº”ç”¨

- **ä¸»åº”ç”¨**: http://localhost:3000
- **é‚®ä»¶ç®¡ç†**: http://localhost:8025 (MailHog)
- **æ•°æ®åº“ç®¡ç†**: http://localhost:8080 (Adminer)

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

### æ ¸å¿ƒç»„ä»¶

**å‰ç«¯ (Next.js 15)**
- å“åº”å¼ç•Œé¢ï¼Œæ”¯æŒæ¡Œé¢å’Œç§»åŠ¨ç«¯
- å®æ—¶é‚®ä»¶åˆ·æ–° (æ¯10ç§’è½®è¯¢)
- ä¸€é”®æ“ä½œï¼šç”Ÿæˆã€å¤åˆ¶ã€åˆ é™¤ã€æ ‡è®°å·²è¯»

**åç«¯ API**
- `POST /api/addresses` - åˆ›å»ºä¸´æ—¶é‚®ç®±
- `GET /api/emails` - è·å–é‚®ä»¶åˆ—è¡¨
- `PATCH /api/emails/[id]` - æ›´æ–°é‚®ä»¶çŠ¶æ€
- `DELETE /api/emails/[id]` - åˆ é™¤é‚®ä»¶
- `POST /api/receive-email` - æ¥æ”¶å¤–éƒ¨é‚®ä»¶
- `POST /api/send-test-email` - å‘é€æµ‹è¯•é‚®ä»¶

**æ•°æ®å±‚**
- PostgreSQL æ•°æ®åº“
- Prisma ORM ç±»å‹å®‰å…¨æ“ä½œ
- è‡ªåŠ¨è¿‡æœŸæ¸…ç†æœºåˆ¶

### æœåŠ¡æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Next.js App   â”‚    â”‚   PostgreSQL    â”‚    â”‚    MailHog      â”‚
â”‚  (Frontend/API) â”‚â”€â”€â”€â”€â”‚   (Database)    â”‚    â”‚ (SMTP Testing)  â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                        â”‚                        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚      Redis      â”‚
                            â”‚   (Optional)    â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âš™ï¸ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡ (.env)

```env
# æ•°æ®åº“
DATABASE_URL="postgresql://tempmail_user:tempmail_pass@localhost:5432/tempmail_db"

# é‚®ä»¶è®¾ç½®
ALLOWED_DOMAINS="tempmail.local,10minutemail.local,guerrillamail.local"
EMAIL_EXPIRATION_MINUTES=60

# SMTP é…ç½®
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_SECURE=false
```

### Docker æœåŠ¡

```yaml
services:
  postgres:    # æ•°æ®åº“ (ç«¯å£ 5432)
  redis:       # ç¼“å­˜ (ç«¯å£ 6379)
  mailhog:     # SMTP (ç«¯å£ 1025) + UI (ç«¯å£ 8025)
  adminer:     # æ•°æ®åº“ç®¡ç† (ç«¯å£ 8080)
```

## ğŸ“‹ API ä½¿ç”¨ç¤ºä¾‹

### åˆ›å»ºé‚®ç®±åœ°å€

```bash
curl -X POST http://localhost:3000/api/addresses \
  -H "Content-Type: application/json" \
  -d '{"expirationMinutes": 60}'
```

### è·å–é‚®ä»¶åˆ—è¡¨

```bash
curl "http://localhost:3000/api/emails?emailAddressId=<ID>"
```

### å‘é€æµ‹è¯•é‚®ä»¶

```bash
curl -X POST http://localhost:3000/api/send-test-email \
  -H "Content-Type: application/json" \
  -d '{
    "to": "example@tempmail.local",
    "subject": "æµ‹è¯•é‚®ä»¶",
    "content": "è¿™æ˜¯æµ‹è¯•å†…å®¹"
  }'
```

## ğŸ”§ å¼€å‘ä»»åŠ¡

### æ•°æ®åº“æ“ä½œ

```bash
npx prisma generate      # ç”Ÿæˆå®¢æˆ·ç«¯
npx prisma migrate dev   # è¿è¡Œè¿ç§»
npx prisma studio        # æ‰“å¼€æ•°æ®æµè§ˆå™¨
npx prisma migrate reset # é‡ç½®æ•°æ®åº“
```

### Docker æ“ä½œ

```bash
docker-compose up -d     # å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose down      # åœæ­¢æœåŠ¡
docker-compose ps        # æŸ¥çœ‹çŠ¶æ€
docker-compose logs -f   # æŸ¥çœ‹æ—¥å¿—
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### ç”¨æˆ·åŠŸèƒ½
- âœ… ä¸€é”®ç”Ÿæˆä¸´æ—¶é‚®ç®±åœ°å€
- âœ… è‡ªåŠ¨æ¥æ”¶é‚®ä»¶
- âœ… å®æ—¶é‚®ä»¶åˆ·æ–°
- âœ… é‚®ä»¶ç®¡ç† (æ ‡è®°å·²è¯»/åˆ é™¤)
- âœ… æµ‹è¯•é‚®ä»¶å‘é€

### å¼€å‘åŠŸèƒ½
- âœ… RESTful API
- âœ… TypeScript ç±»å‹å®‰å…¨
- âœ… Docker å¼€å‘ç¯å¢ƒ
- âœ… æ•°æ®åº“ç®¡ç†å·¥å…·
- âœ… SMTP æµ‹è¯•å·¥å…·

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**æ•°æ®åº“è¿æ¥å¤±è´¥**
```bash
docker-compose restart postgres
npx prisma db push
```

**SMTP å‘é€å¤±è´¥**
```bash
docker logs tempmail-mailhog
# è®¿é—® http://localhost:8025 æ£€æŸ¥é‚®ä»¶
```

**ç«¯å£å ç”¨**
```bash
# æ£€æŸ¥ç«¯å£ä½¿ç”¨æƒ…å†µ
lsof -i :3000
lsof -i :5432
```

## ğŸš€ éƒ¨ç½²å‡†å¤‡

### ç”Ÿäº§ç¯å¢ƒé…ç½®

1. **ç¯å¢ƒå˜é‡**
   - é…ç½®ç”Ÿäº§æ•°æ®åº“è¿æ¥
   - è®¾ç½®çœŸå®SMTPæœåŠ¡å™¨
   - é…ç½®åŸŸåå’ŒSSL

2. **æ€§èƒ½ä¼˜åŒ–**
   - å¯ç”¨æ•°æ®åº“è¿æ¥æ± 
   - é…ç½®Redisç¼“å­˜
   - è®¾ç½®CDNåŠ é€Ÿ

3. **å®‰å…¨è®¾ç½®**
   - é™åˆ¶APIè®¿é—®é¢‘ç‡
   - é…ç½®CORSç­–ç•¥
   - å¯ç”¨è¯·æ±‚æ—¥å¿—

---

**ğŸ‰ é¡¹ç›®å·²å®Œå…¨å®ç°å¹¶å¯æŠ•å…¥ä½¿ç”¨ï¼** æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ç»è¿‡æµ‹è¯•éªŒè¯ï¼Œå¯ç«‹å³éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚ 